# ObsCraft

A lightweight log analysis & alerting platform based on Nginx + Flask + Kafka + Filebeat + MySQL (v1) ğŸš€  
æœªæ¥å°†æ”¯æŒï¼šELKã€Prometheus+Grafanaã€Celery å¼‚æ­¥ä»»åŠ¡ã€Docker/K8s å®¹å™¨åŒ–ã€AI è‡ªç„¶è¯­è¨€æŸ¥è¯¢ï¼ˆå¤§æ¨¡å‹ API é›†æˆï¼‰

---

## âœ… å½“å‰ç‰ˆæœ¬ï¼ˆv1ï¼‰åŠŸèƒ½æ¦‚è§ˆ

- âœ… **Nginx è´Ÿè½½å‡è¡¡**ï¼šä¸‰èŠ‚ç‚¹ Flask åç«¯æœåŠ¡åˆ†å‘  
- âœ… **æ—¥å¿—é‡‡é›†**ï¼šFilebeat å®æ—¶é‡‡é›† Nginx è®¿é—®/é”™è¯¯æ—¥å¿—ï¼ˆ`/personal-website/logs/`ï¼‰  
- âœ… **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šKafka é›†ç¾¤ï¼ˆKRaft æ¨¡å¼ï¼Œæ—  ZooKeeperï¼‰ç¼“å†²æ—¥å¿—æµ  
- âœ… **æ—¥å¿—æ¶ˆè´¹ä¸å­˜å‚¨**ï¼šPython æ¶ˆè´¹è€…ç¨‹åºè§£ææ—¥å¿—å¹¶å†™å…¥ MySQL  
- âœ… **å®æ—¶å‘Šè­¦**ï¼šé«˜é¢‘è¯·æ±‚æˆ– 4xx/5xx é”™è¯¯è§¦å‘ **é’‰é’‰æœºå™¨äººé€šçŸ¥**  
- âœ… **ä¸€é”®éƒ¨ç½²**ï¼šæä¾› `start.sh` è„šæœ¬å¿«é€Ÿå¯åŠ¨å…¨æ ˆæœåŠ¡  
- âœ… **é«˜å¯ç”¨éªŒè¯**ï¼šé€šè¿‡ `X-Backend-Server` å“åº”å¤´éªŒè¯è´Ÿè½½å‡è¡¡æ•ˆæœ  

---

## ğŸ–¥ï¸ æ¶æ„æ‹“æ‰‘ï¼ˆv1ï¼‰

```
ç”¨æˆ·è¯·æ±‚
â”‚
â–¼
[Nginx @ kafka1] â†â”€â”€â”
â”‚                â”‚
â–¼                â”‚ è´Ÿè½½å‡è¡¡ (least_conn)
[Flask App] @ kafka1/kafka2/kafka3
â”‚
â–¼
Nginx æ—¥å¿— â†’ /personal-website/logs/{access,error}.log
â”‚
â–¼
[Filebeat] â†’ [Kafka Cluster] â†’ [Consumer @ kafka1] â†’ [MySQL]
â”‚
â–¼
[DingTalk Alert]
```


---

## ğŸ› ï¸ æŠ€æœ¯æ ˆï¼ˆv1ï¼‰

| ç»„ä»¶        | ç‰ˆæœ¬/è¯´æ˜                     |
|-------------|-----------------------------|
| æ“ä½œç³»ç»Ÿ     | CentOS 7.9                  |
| Web æœåŠ¡å™¨   | Nginx                       |
| åº”ç”¨æ¡†æ¶     | Python Flask                |
| æ—¥å¿—é‡‡é›†     | Filebeat                    |
| æ¶ˆæ¯é˜Ÿåˆ—     | Apache Kafka 3.x+ (KRaft)   |
| æ•°æ®åº“       | MySQL 5.7                   |
| ç¼“å­˜         | Redisï¼ˆç”¨äºæµé‡ç»Ÿè®¡ï¼‰        |
| å‘Šè­¦é€šé“     | é’‰é’‰æœºå™¨äºº Webhook          |
| éƒ¨ç½²æ–¹å¼     | æ‰‹åŠ¨éƒ¨ç½² + systemd ç®¡ç†     |

---

## ğŸ”® æœªæ¥æ¼”è¿›è·¯çº¿

| é˜¶æ®µ | ç›®æ ‡ |
|------|------|
| v2 | å¼•å…¥ Celery + Redis å®ç°å¼‚æ­¥ä»»åŠ¡è§£è€¦ |
| v3 | é›†æˆ ELK Stack å®ç°æ—¥å¿—å¯è§†åŒ–åˆ†æ |
| v4 | æ·»åŠ  Prometheus + Grafana å®æ—¶ç›‘æ§ |
| v5 | Docker å®¹å™¨åŒ– + docker-compose ç¼–æ’ |
| v6 | Kubernetes éƒ¨ç½²ï¼Œæ”¯æŒè‡ªåŠ¨æ‰©ç¼©å®¹ |
| v7+ | AI å¢å¼ºï¼šé›†æˆå¤§æ¨¡å‹ APIï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢æ—¥å¿— |

---

## ğŸ“„ æ–‡æ¡£

- `docs/deployment-manual-v1.md`ï¼šv1 ç‰ˆæœ¬è¯¦ç»†éƒ¨ç½²æ‰‹å†Œ
